<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="team2">

<select id="selectUser" parameterType="int" resultType="hashmap">
	SELECT name, id, password, phone_num, dept_num, email, starmark, team
	FROM user
	WHERE id = #{id}
</select>

<select id="team" parameterType="int" resultType="hashmap">
	SELECT rank, dept
	FROM team
	WHERE pk = #{pk}
</select>

<!--
 쿼리명 : user columns 
 설명 : user의 컬럼
 작성자 : 문예빈
 최초작성일 : 2022-05-24
 -->
<sql id="userColumns">
	${user}.id, ${user}.name, ${user}.password, ${user}.phone_num, ${user}.dept_num, ${user}.email, ${user}.starmark, ${user}.mytag, ${user}.team
</sql>

<!--
 쿼리명 : team cloumns
 설명 : team의 컬럼(rank, dept)
 작성자 : 문예빈
 최초작성일 : 2022-05-24
 -->
<sql id="teamColumns">
	${team}.rank, ${team}.dept
</sql>

<!--
 쿼리명 : 소속부서 (team)
 설명 : 작성자의 소속부서를 찾는 쿼리(dept, rank)
 작성자 : 문예빈
 최초작성일 : 2022-05-24
 -->
 <select id="selectTeam">
 	SELECT
 		<include refid="teamColumns"></include>
 </select>
 


<!--
 쿼리명 : 문서리스트
 설명 : 문서리스트의 번호/제목/다운/기관/작성일/작성자 를 선택하는 쿼리문
 작성자 : 문예빈
 최초작성일 : 2022-05-24
 -->
 <select id="boardList">
 	SELECT b.board_pk,
 			b.title,
 			b.file,
 			d.description,
 			b.date,
 			u.name
 	FROM board b
		JOIN user u ON b.user = u.user_pk
		JOIN team t ON t.team_pk = u.team
		JOIN department d ON d.dept_pk = t.dept
 	WHERE u.user_pk = b.user
 </select>

<!-- 
	쿼리명 : 게시판 정보(rank)
	설 명 : user테이블에서 team테이블의 rank를 뽑아오는 쿼리 (유저이름, 소속부서, 직급, 부서 번호)
	작성자 : 문예빈
 	최초 작성일 : 2022-05-19
 -->
<select id="selectRank">
	SELECT u.name, 
		u.team, 
		u.dept_num, 
		t.rank
	FROM user u, 
		team t
	WHERE u.team = #{t.pk}
</select>

<!--
	쿼리명 : 게시판 정보(date)
	설 명 : 
	SELECT date,
		start_date,
		end_date
	FROM board
	where 
	작성자 : 문예빈
	최초 작성일 : 2022-20
  -->



<insert id="test">
	INSERT INTO department VALUES ()
</insert>

<sql id="userColumns">

</sql>

<sql id="allCoulm">
8,'설명',1,'별','주소','경로'
incl
</sql>

</mapper>